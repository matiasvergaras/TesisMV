/home/mavergar/TesisMV/notebooks/ex-on-relela-2.py:84: UserWarning: Iniciando DS_FLAGS ['ref', 'rot']
  warnings.warn(f"Iniciando DS_FLAGS {DS_FLAGS}")
/home/mavergar/anaconda3/envs/tesis_env/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(
/home/mavergar/anaconda3/envs/tesis_env/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/mavergar/TesisMV/notebooks/ex-on-relela-2.py:84: UserWarning: Iniciando DS_FLAGS ['ref', 'rot', 'rain']
  warnings.warn(f"Iniciando DS_FLAGS {DS_FLAGS}")
Pattern set encontrado en ../patterns/ref_rot/0
Labels set encontrado en ../labels/ref_rot/0
El modelo resultante se guardará en ../models/resnet/ref_rot/
Usando  cuda:0
Epoch 0/79
----------
Train Loss: 1.7662  Acc: 0.3325
Val Loss: 1.4479  Acc: 0.5513
Epoch 1/79
----------
Train Loss: 1.4988  Acc: 0.4082
Val Loss: 3.1842  Acc: 0.2179
Epoch 2/79
----------
Train Loss: 1.3422  Acc: 0.4926
Val Loss: 1.6232  Acc: 0.4231
Epoch 3/79
----------
Train Loss: 1.2478  Acc: 0.5279
Val Loss: 1.4175  Acc: 0.5128
Epoch 4/79
----------
Train Loss: 1.2068  Acc: 0.5592
Val Loss: 1.2816  Acc: 0.5769
Epoch 5/79
----------
Train Loss: 1.0806  Acc: 0.6018
Val Loss: 1.5841  Acc: 0.5256
Epoch 6/79
----------
Train Loss: 1.0305  Acc: 0.6101
Val Loss: 1.5082  Acc: 0.6154
Epoch 7/79
----------
Train Loss: 0.9899  Acc: 0.6514
Val Loss: 1.2714  Acc: 0.5769
Epoch 8/79
----------
Train Loss: 0.9372  Acc: 0.6619
Val Loss: 1.7998  Acc: 0.4487
Epoch 9/79
----------
Train Loss: 0.8977  Acc: 0.6684
Val Loss: 1.2529  Acc: 0.6154
Epoch 10/79
----------
Train Loss: 0.8680  Acc: 0.6997
Val Loss: 1.2452  Acc: 0.6282
Epoch 11/79
----------
Train Loss: 0.8547  Acc: 0.6915
Val Loss: 1.1211  Acc: 0.6282
Epoch 12/79
----------
Train Loss: 0.7948  Acc: 0.7176
Val Loss: 1.3068  Acc: 0.5897
Epoch 13/79
----------
Train Loss: 0.7482  Acc: 0.7398
Val Loss: 1.2108  Acc: 0.6667
Epoch 14/79
----------
Train Loss: 0.7731  Acc: 0.7289
Val Loss: 1.2502  Acc: 0.6538
Epoch 15/79
----------
Train Loss: 0.7394  Acc: 0.7376
Val Loss: 1.1974  Acc: 0.6410
Epoch 16/79
----------
Train Loss: 0.6881  Acc: 0.7615
Val Loss: 1.1523  Acc: 0.6026
Epoch 17/79
----------
Train Loss: 0.7147  Acc: 0.7567
Val Loss: 1.4960  Acc: 0.5897
Epoch 18/79
----------
Train Loss: 0.6610  Acc: 0.7633
Val Loss: 1.3876  Acc: 0.6410
Epoch 19/79
----------
Train Loss: 0.6508  Acc: 0.7715
Val Loss: 1.3181  Acc: 0.6538
Epoch 20/79
----------
Train Loss: 0.6198  Acc: 0.7772
Val Loss: 1.0449  Acc: 0.7051
Epoch 21/79
----------
Train Loss: 0.5922  Acc: 0.7842
Val Loss: 1.3805  Acc: 0.6795
Epoch 22/79
----------
Train Loss: 0.5974  Acc: 0.7833
Val Loss: 1.1735  Acc: 0.6923
Epoch 23/79
----------
Train Loss: 0.5636  Acc: 0.7937
Val Loss: 1.1228  Acc: 0.6667
Epoch 24/79
----------
Train Loss: 0.5628  Acc: 0.7972
Val Loss: 1.0676  Acc: 0.7436
Epoch 25/79
----------
Train Loss: 0.5626  Acc: 0.8037
Val Loss: 1.0138  Acc: 0.7051
Epoch 26/79
----------
Train Loss: 0.5480  Acc: 0.7998
Val Loss: 1.2458  Acc: 0.6154
Epoch 27/79
----------
Train Loss: 0.5404  Acc: 0.8146
Val Loss: 1.1600  Acc: 0.7051
Epoch 28/79
----------
Train Loss: 0.5189  Acc: 0.8207
Val Loss: 1.3080  Acc: 0.6282
Epoch 29/79
----------
Train Loss: 0.5011  Acc: 0.8325
Val Loss: 1.5839  Acc: 0.6667
Epoch 30/79
----------
Train Loss: 0.4794  Acc: 0.8351
Val Loss: 1.2616  Acc: 0.6923
Epoch 31/79
----------
Train Loss: 0.4951  Acc: 0.8346
Val Loss: 1.5402  Acc: 0.6538
Epoch 32/79
----------
Train Loss: 0.4660  Acc: 0.8355
Val Loss: 1.0131  Acc: 0.7436
Epoch 33/79
----------
Train Loss: 0.4470  Acc: 0.8503
Val Loss: 1.1456  Acc: 0.7051
Epoch 34/79
----------
Train Loss: 0.4141  Acc: 0.8529
Val Loss: 1.3431  Acc: 0.6538
Epoch 35/79
----------
Train Loss: 0.4702  Acc: 0.8364
Val Loss: 1.3026  Acc: 0.6923
Epoch 36/79
----------
Train Loss: 0.4723  Acc: 0.8338
Val Loss: 1.3052  Acc: 0.6795
Epoch 37/79
----------
Train Loss: 0.4283  Acc: 0.8529
Val Loss: 1.2841  Acc: 0.6538
Epoch 38/79
----------
Train Loss: 0.4447  Acc: 0.8412
Val Loss: 1.5988  Acc: 0.6795
Epoch 39/79
----------
Train Loss: 0.4416  Acc: 0.8516
Val Loss: 1.1116  Acc: 0.6923
Epoch 40/79
----------
Train Loss: 0.3967  Acc: 0.8638
Val Loss: 1.3685  Acc: 0.6667
Epoch 41/79
----------
Train Loss: 0.4387  Acc: 0.8433
Val Loss: 1.4451  Acc: 0.6667
Epoch 42/79
----------
Train Loss: 0.3737  Acc: 0.8734
Val Loss: 1.4798  Acc: 0.6923
Epoch 43/79
----------
Train Loss: 0.4018  Acc: 0.8529
Val Loss: 1.4872  Acc: 0.6282
Epoch 44/79
----------
Train Loss: 0.4029  Acc: 0.8499
Val Loss: 1.2627  Acc: 0.6923
Epoch 45/79
----------
Train Loss: 0.3730  Acc: 0.8651
Val Loss: 1.4666  Acc: 0.6923
Epoch 46/79
----------
Train Loss: 0.3404  Acc: 0.8799
Val Loss: 1.4791  Acc: 0.6538
Epoch 47/79
----------
Train Loss: 0.3451  Acc: 0.8725
Val Loss: 1.4059  Acc: 0.7051
Se agotó la paciencia. Mejor época: 32.
Best accuracy: 0.7436
Test Loss: 0.4895  Acc: 0.8505
Pattern set encontrado en ../patterns/rain_ref_rot/0
Labels set encontrado en ../labels/rain_ref_rot/0
El modelo resultante se guardará en ../models/resnet/rain_ref_rot/
Usando  cuda:0
Epoch 0/79
----------
Train Loss: 1.6884  Acc: 0.3647
Val Loss: 1.5567  Acc: 0.4615
Epoch 1/79
----------
Train Loss: 1.4080  Acc: 0.4607
Val Loss: 1.4976  Acc: 0.5256
Epoch 2/79
----------
Train Loss: 1.3144  Acc: 0.4932
Val Loss: 1.2359  Acc: 0.5385
Epoch 3/79
----------
Train Loss: 1.2309  Acc: 0.5228
Val Loss: 1.0740  Acc: 0.6154
Epoch 4/79
----------
Train Loss: 1.1343  Acc: 0.5742
Val Loss: 1.3564  Acc: 0.5000
Epoch 5/79
----------
Train Loss: 1.0573  Acc: 0.6021
Val Loss: 1.6485  Acc: 0.5128
Epoch 6/79
----------
Train Loss: 1.0482  Acc: 0.6128
Val Loss: 1.2614  Acc: 0.6282
Epoch 7/79
----------
Train Loss: 0.9837  Acc: 0.6378
Val Loss: 1.1933  Acc: 0.5897
Epoch 8/79
----------
Train Loss: 0.9542  Acc: 0.6585
Val Loss: 1.0368  Acc: 0.6923
Epoch 9/79
----------
Train Loss: 0.8545  Acc: 0.7009
Val Loss: 1.0979  Acc: 0.7436
Epoch 10/79
----------
Train Loss: 0.8913  Acc: 0.6934
Val Loss: 1.0364  Acc: 0.6410
Epoch 11/79
----------
Train Loss: 0.8042  Acc: 0.7109
Val Loss: 1.1535  Acc: 0.6923
Epoch 12/79
----------
Train Loss: 0.7627  Acc: 0.7355
Val Loss: 1.2218  Acc: 0.6282
Epoch 13/79
----------
Train Loss: 0.7686  Acc: 0.7320
Val Loss: 1.1075  Acc: 0.6538
Epoch 14/79
----------
Train Loss: 0.7385  Acc: 0.7413
Val Loss: 1.1805  Acc: 0.6154
Epoch 15/79
----------
Train Loss: 0.7252  Acc: 0.7523
Val Loss: 1.1564  Acc: 0.6795
Epoch 16/79
----------
Train Loss: 0.6957  Acc: 0.7555
Val Loss: 1.0847  Acc: 0.6410
Epoch 17/79
----------
Train Loss: 0.6720  Acc: 0.7687
Val Loss: 1.1091  Acc: 0.7051
Epoch 18/79
----------
Train Loss: 0.6339  Acc: 0.7830
Val Loss: 1.2172  Acc: 0.6538
Epoch 19/79
----------
Train Loss: 0.6151  Acc: 0.7777
Val Loss: 1.1527  Acc: 0.7308
Epoch 20/79
----------
Train Loss: 0.6145  Acc: 0.7880
Val Loss: 0.9588  Acc: 0.7564
Epoch 21/79
----------
Train Loss: 0.5513  Acc: 0.8062
Val Loss: 1.0560  Acc: 0.7051
Epoch 22/79
----------
Train Loss: 0.5438  Acc: 0.8034
Val Loss: 0.9825  Acc: 0.7308
Epoch 23/79
----------
Train Loss: 0.5223  Acc: 0.8194
Val Loss: 1.1976  Acc: 0.7308
Epoch 24/79
----------
Train Loss: 0.5436  Acc: 0.8098
Val Loss: 0.8625  Acc: 0.7564
Epoch 25/79
----------
Train Loss: 0.5082  Acc: 0.8258
Val Loss: 1.0508  Acc: 0.7564
Epoch 26/79
----------
Train Loss: 0.4880  Acc: 0.8291
Val Loss: 0.8719  Acc: 0.7949
Epoch 27/79
----------
Train Loss: 0.4905  Acc: 0.8312
Val Loss: 0.9288  Acc: 0.7564
Epoch 28/79
----------
Train Loss: 0.4744  Acc: 0.8351
Val Loss: 1.1529  Acc: 0.7564
Epoch 29/79
----------
Train Loss: 0.4582  Acc: 0.8358
Val Loss: 1.0529  Acc: 0.7308
Epoch 30/79
----------
Train Loss: 0.5044  Acc: 0.8226
Val Loss: 1.0586  Acc: 0.7564
Epoch 31/79
----------
Train Loss: 0.4638  Acc: 0.8355
Val Loss: 1.2093  Acc: 0.7051
Epoch 32/79
----------
Train Loss: 0.4314  Acc: 0.8451
Val Loss: 1.0246  Acc: 0.7051
Epoch 33/79
----------
Train Loss: 0.4449  Acc: 0.8469
Val Loss: 1.0650  Acc: 0.7308
Epoch 34/79
----------
Train Loss: 0.4169  Acc: 0.8576
Val Loss: 0.9630  Acc: 0.7821
Epoch 35/79
----------
Train Loss: 0.4438  Acc: 0.8544
Val Loss: 1.0996  Acc: 0.6667
Epoch 36/79
----------
Train Loss: 0.4369  Acc: 0.8469
Val Loss: 1.0094  Acc: 0.6795
Epoch 37/79
----------
Train Loss: 0.3911  Acc: 0.8683
Val Loss: 0.9654  Acc: 0.7949
Epoch 38/79
----------
Train Loss: 0.3839  Acc: 0.8722
Val Loss: 1.1303  Acc: 0.7436
Epoch 39/79
----------
Train Loss: 0.3767  Acc: 0.8694
Val Loss: 0.8211  Acc: 0.7564
Epoch 40/79
----------
Train Loss: 0.3977  Acc: 0.8590
Val Loss: 0.6510  Acc: 0.8077
Epoch 41/79
----------
Train Loss: 0.3564  Acc: 0.8754
Val Loss: 0.8483  Acc: 0.7692
Epoch 42/79
----------
Train Loss: 0.3454  Acc: 0.8837
Val Loss: 1.0705  Acc: 0.7821
Epoch 43/79
----------
Train Loss: 0.3524  Acc: 0.8858
Val Loss: 0.6956  Acc: 0.7436
Epoch 44/79
----------
Train Loss: 0.3427  Acc: 0.8858
Val Loss: 0.9679  Acc: 0.7564
Epoch 45/79
----------
Train Loss: 0.3376  Acc: 0.8851
Val Loss: 0.9601  Acc: 0.7564
Epoch 46/79
----------
Train Loss: 0.3507  Acc: 0.8851
Val Loss: 0.9956  Acc: 0.8077
Epoch 47/79
----------
Train Loss: 0.3285  Acc: 0.8922
Val Loss: 1.4301  Acc: 0.7564
Epoch 48/79
----------
Train Loss: 0.3282  Acc: 0.8862
Val Loss: 1.1302  Acc: 0.7821
Epoch 49/79
----------
Train Loss: 0.3143  Acc: 0.8979
Val Loss: 0.8963  Acc: 0.7821
Epoch 50/79
----------
Train Loss: 0.3046  Acc: 0.8947
Val Loss: 1.0609  Acc: 0.7692
Epoch 51/79
----------
Train Loss: 0.3228  Acc: 0.8904
Val Loss: 1.0986  Acc: 0.7692
Epoch 52/79
----------
Train Loss: 0.2847  Acc: 0.9008
Val Loss: 0.9649  Acc: 0.7436
Epoch 53/79
----------
Train Loss: 0.2894  Acc: 0.8961
Val Loss: 0.9528  Acc: 0.7949
Epoch 54/79
----------
Train Loss: 0.3067  Acc: 0.8901
Val Loss: 1.1074  Acc: 0.7692
Epoch 55/79
----------
Train Loss: 0.2763  Acc: 0.9044
Val Loss: 1.0136  Acc: 0.7308
Se agotó la paciencia. Mejor época: 40.
Best accuracy: 0.8077
Test Loss: 0.5577  Acc: 0.8402
